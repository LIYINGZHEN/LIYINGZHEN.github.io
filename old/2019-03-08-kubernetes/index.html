<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author"
    content="     &#34;Max&#34;">
<meta name="description"
    content="Terminology Minikube: Minikube is a tool that sets up a single-node cluster that’s great for both testing Kubernetes and developing apps locally.
Kubelet:
Master Node: The master node, which hosts the Kubernetes Control Plane that controls and manages the whole Kubernetes system.
Node: Worker nodes that run the actual applications you deploy.
Pod: Running containers in Kubernetes.
Service: Enabling clients to discover and talk to pods.
Commands General Commands # Starting a Minikube virtual machine." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://www.maxlivinci.com/old/2019-03-08-kubernetes/" />


<title>
    
    Kubernetes :: YING ZHEN LI 
    
</title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://www.maxlivinci.com/main.min.6a7678f40434c7781747ffdd224a984179b2a3c81c81f19ccf845fdffbe80b7c.css">



<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#252627">
<link rel="shortcut icon" href="/favicon.ico">
<meta name="theme-color" content="#252627">
<meta itemprop="name" content="Kubernetes">
<meta itemprop="description" content=" ">


<meta itemprop="datePublished" content="2019-03-08T12:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2019-03-08T12:00:00&#43;00:00" />
<meta itemprop="wordCount" content="1073">



<meta itemprop="keywords" content="kubernetes," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://www.maxlivinci.com"/>

<meta name="twitter:title" content="Kubernetes"/>
<meta name="twitter:description" content=" "/>



<meta property="article:section" content="notes" />

<meta property="article:published_time" content="2019-03-08 12:00:00 &#43;0000 &#43;0000" />







    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">cd $HOME</span>
            <span class="logo__cursor"></span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://www.maxlivinci.com/about">About</a></li><li><a href="https://www.maxlivinci.com/blog">Blog</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://www.maxlivinci.com/old/2019-03-08-kubernetes/">Kubernetes</a></h2>

            

            <div class="post-content">
                

<h1 id="terminology">Terminology</h1>

<p><strong>Minikube</strong>: Minikube is a tool that sets up a single-node cluster that’s great for both testing Kubernetes and developing apps locally.</p>

<p><strong>Kubelet</strong>:</p>

<p><strong>Master Node</strong>: The master node, which hosts the Kubernetes Control Plane that controls and manages the whole Kubernetes system.</p>

<p><strong>Node</strong>: Worker nodes that run the actual applications you deploy.</p>

<p><strong>Pod</strong>: Running containers in Kubernetes.</p>

<p><strong>Service</strong>: Enabling clients to discover and talk to pods.</p>

<h1 id="commands">Commands</h1>

<h2 id="general-commands">General Commands</h2>

<pre><code class="language-bash"># Starting a Minikube virtual machine.
minikube start

# Displaying cluster information.
kubectl cluster-info

# Using kubectl explain to discover possible API object fields.
kubectl explain pods

#
cat ~/.kube/config

# Connect between our host and the kubernetes cluster.
kubectl proxy

# Forwarding a local network port to a port in the pod.
kubectl port-forward &lt;pod-name&gt; 8888:8080
</code></pre>

<h2 id="deployment-commands">Deployment Commands</h2>

<pre><code class="language-bash"># List deployments.
kubectl get deployments

# Show the status of the rollout.
kubectl rollout status deployment/service

#
kubectl describe deployment
kubectl describe deployments/&lt;deployments-name&gt;
</code></pre>

<h2 id="pod-commands">Pod Commands</h2>

<pre><code class="language-bash"># Apply pod config.
kubectl apply -f pod.yaml

# See the full descriptor of the pod.
kubectl get po &lt;pod-name&gt; -o yaml
# Look for existing Pods.
kubectl get po &lt;pod-name&gt; -o wide
kubectl get po &lt;pod-name&gt; --show-labels
# Listing pods using a label selector
kubectl get po -l &lt;label-name&gt;=&lt;label-value&gt;
# List all pods (include completed pods)
kubectl get po -a

# Check application configuration.
kubectl describe po
kubectl describe po/&lt;pod-name&gt;

# View the container logs
kubectl logs -f &lt;pod-name&gt;

# Executing command on the container
kubectl exec &lt;pod-name&gt; env
# Get a shell to a running pod.
kubectl exec -it &lt;pod-name&gt; sh | bash
#
kubectl exec &lt;pod-name&gt; -- curl -s http://10.111.249.153

# Delete pod.
kubectl delete po &lt;pod-name&gt;
# Deleting pods using label selectors
kubectl delete po -l rel=canary
</code></pre>

<h2 id="ingress-commands">Ingress Commands</h2>

<pre><code class="language-bash">kubectl get ingresses
</code></pre>

<h2 id="service-commands">Service Commands</h2>

<pre><code class="language-bash"># Apply service config.
kubectl apply -f service.yaml

# List the current Services.
kubectl get svc
kubectl get svc/&lt;service-name&gt;

#
kubectl describe svc
kubectl describe svc/&lt;service-name&gt;

#
kubectl get endpoints &lt;service-name&gt;

# Delete service.
kubectl delete svc &lt;service-name&gt;
</code></pre>

<h2 id="node-commands">Node Commands</h2>

<pre><code class="language-bash"># Using JSONPath to get the IPs of all your nodes
kubectl get nodes -o jsonpath='{.items[*].status. ➥ addresses[?(@.type==&quot;ExternalIP&quot;)].address}'

# Listing cluster nodes.
kubectl get nodes

#
kubectl describe node
kubectl describe node/&lt;node-name&gt;
</code></pre>

<h2 id="namespace-commands">Namespace Commands</h2>

<pre><code class="language-bash"># Listing name spaces.
kubectl get ns

# Deleting pods by deleting the whole namespace.
kubectl delete ns custom-namespace
</code></pre>

<h1 id="yaml">YAML</h1>

<h2 id="deployment">Deployment</h2>

<pre><code class="language-yaml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: max-backend
  labels:
    app: max-backend
spec:
  # The desired number of pod instances.
  replicas: 5
  # The pod selector determining what pods the RC is operating on.
  selector:
    matchLabels:
      app: max-backend
  template:
    metadata:
      labels:
        app: max-backend
    spec:
      # nodeSelector tells Kubernetes to deploy this pod only to nodes containing the gpu=true label.
      nodeSelector:
        gpu: &quot;true&quot;
      containers:
      - name: max-backend
        image: max-docker-registry.system:5000/appbackend:&lt;commit-hash&gt;
        # Environment variables.
        env:
        - name:
          value:
        #
        ports:
        - name: api
          containerPort: 3030
        #
        livenessProbe:
          httpGet:
            # A liveness probe that will perform an HTTP GET
            path: /api/health
            port: 3030
          # Kubernetes will wait 15 seconds before executing the first probe.
          initialDelaySeconds: 30
          periodSeconds: 60
          failureThreshold: 2
          timeoutSeconds: 20
        readinessProbe:
          httpGet:
            path: /api/health
            port: 3030
          initialDelaySeconds: 30
          periodSeconds: 20
          timeoutSeconds: 19
          failureThreshold: 2
</code></pre>

<h2 id="ingress">Ingress</h2>

<blockquote>
<p>Exposes one or more services to external clients through a single externally reachable IP address.</p>
</blockquote>

<pre><code class="language-yaml">apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  name: max-backend
spec:
  rules:
  # This Ingress maps the api.my-app.com domain name to your service.
  - host: api.my-app.com
    http:
      paths:
      - path: /
        backend:
          serviceName: max-backend
          servicePort: 3030
</code></pre>

<h2 id="service">Service</h2>

<pre><code class="language-yaml">apiVersion: v1
kind: Service
metadata:
  name: max-backend
spec:
  clusterIP: None # This makes the service headless.
  ports:
  - name: api
    # Port is the port number which makes a service visible to other services running within the same K8s cluster
    port: 3030
    # Target port is the port on the POD where the service is running.
    targetPort: 3030
  selector:
    # All pods with the app=max-backend label will be part of this service.
    app: max-backend
</code></pre>

<p><strong>Exposing services to external clients.</strong></p>

<pre><code class="language-yaml">apiVersion: v1
kind: Service
metadata:
  name: max-backend
spec:
  type: LoadBalancer
  ports:
  - name: http
    port: 80         # This is the port of the service’s internal cluster IP.
    targetPort: 8080 # This is the target port of the backing pods.
  selector:
    # All pods with the app=max-backend label will be part of this service.
    app: max-backend
</code></pre>

<pre><code class="language-yaml">apiVersion: v1
kind: Service
metadata:
  name: max-backend
spec:
  type: NodePort
  ports:
  - name: http
    port: 8080 # This is the port of the service’s internal cluster IP.
    targetPort: 80 # This is the target port of the backing pods.
    # Node port is the port on which the service can be accessed from external users using Kube-Proxy.
    nodePort: 30001
  - name: https
    port: 443
    targetPort: 8443
  selector:
    # All pods with the app=max-backend label will be part of this service.
    app: max-backend
</code></pre>

<hr />

<h2 id="namespace">Namespace</h2>

<pre><code class="language-yaml">apiVersion: v1
kind: Namespace
metadata:
  name: custom-namespace
</code></pre>

<h2 id="job">Job</h2>

<blockquote>
<p>Runs pods that perform a completable task</p>
</blockquote>

<pre><code class="language-yaml">apiVersion: batch/v1
kind: Job
metadata:
  name: batch-job
spec:
  # Setting completions to 5 makes this Job run five pods sequentially.
  completions: 5
  # Up to two pods can run in parallel.
  parallelism: 2
  template:
    metadata:
      labels:
        app: batch-job
    spec:
      restartPolicy: OnFailure
      containers:
      - name: main
        image: luksa/batch-job
</code></pre>

<h2 id="cronjob">CronJob</h2>

<blockquote>
<p>Runs a scheduled job once or periodically</p>
</blockquote>

<pre><code class="language-yaml">apiVersion: batch/v1beta1
kind: CronJob
metadata:
    name: batch-job-every-fifteen-minutes
spec:
  schedule: &quot;0,15,30,45 * * * *&quot;
  # At the latest, the pod must start running at 15 seconds past the scheduled time.
  startingDeadlineSeconds: 15
  jobTemplate:
    spec:
      template:
        metadata:
          labels:
            app: periodic-batch-job
        spec:
          restartPolicy: OnFailure
          containers:
          - name: main
            image: luksa/batch-job
</code></pre>

<hr />

<blockquote>
<p>Pods shouldn’t be created directly, because they will not be re-created if they’re deleted by mistake, if the node they’re running on fails, or if they’re evicted from the node.</p>
</blockquote>

<h2 id="pod">Pod</h2>

<pre><code class="language-yaml">apiVersion: v1
kind: Pod
# Metadata includes the name, namespace, labels, and other information about the pod.
metadata:
  # The name of the pod
  name: my-pod
  labels:
    app: webserver
# Spec contains the actual description of the pod’s contents, such as the pod’s con- tainers, volumes, and other data.
spec:
  containers:
  # Name of the containe
  - name: pod-demo
    # Container image to create the container from
    image: &lt;image-name&gt;
    ports:
    # The port the app is listening on
    - containerPort: 3000
      protocol: TCP
    livenessProbe:
      # A liveness probe that will perform an HTTP GET
      httpGet:
        # The path to request in the HTTP request
        path: /api/health
        port: 8080
      # Kubernetes will wait 15 seconds before executing the first probe.
      initialDelaySeconds: 30
</code></pre>

<h2 id="replicationcontrollers">ReplicationControllers</h2>

<blockquote>
<p>ReplicationControllers should be replaced with ReplicaSets and Deployments, which provide the same functionality, but with additional powerful features.</p>
</blockquote>

            </div>
        </article>

        <hr />

        <div class="post-info">
  				<p>
  					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://www.maxlivinci.com/tags/kubernetes">kubernetes</a></span>
  				</p>
  			</div>

        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2018 - 2019</span>
            
                <span>Max Li</span>
            
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">

        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
        </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="https://www.maxlivinci.com/bundle.min.cf7871ed49474a80ed457154d24e61f7881adbe0f9384951a74ac46b688a39a4dbfa68bc6d37baeb058186de354ead3487d4ee7f083ea4cba860c48600b694f3.js" integrity="sha512-z3hx7UlHSoDtRXFU0k5h94ga2&#43;D5OElRp0rEa2iKOaTb&#43;mi8bTe66wWBht41Tq00h9Tufwg&#43;pMuoYMSGALaU8w=="></script>



    </body>
</html>
